import{_ as D,B as I,W as w,X as k,d as l,$ as C,o as d,c as n,a,e as _,t as u,O as x,k as g,F as L,m as M,n as $,j as B,Y,b as h,w as S,r as v,p as V,f as A,g as p}from"./index-BlMJxPGQ.js";import{L as N}from"./Loader-DR0R9oEF.js";import{a as W}from"./cart-QHhiBhPv.js";import{u as U}from"./instructorLedTraining-DE_vpi5U.js";import"./event-bus-DYoA24Gz.js";import{_ as O}from"./info-modal-training-icon-Dm7yAfS1.js";const j={props:["listView","timeSlotsList","userId","operations"],data(){return{courseDetails:{},loaderStatus:!1,selectedSlotId:null,availableTimeSlots:[]}},components:{Loader:N,BaseButton:I},computed:{eventsNone(){return this.operations.type==="select"?!this.selectedSlotId:this.selectedSlotId===this.operations.selectedSlotId}},watch:{courseDetails(){this.listView&&this.courseDetails&&this.getTimeSlotsList()},operations:{handler(t){t.type==="select"?this.setCourseDetails():t.type==="edit"&&this.setSelectedDetails()},deep:!0},timeSlotsList(t){t&&(this.availableTimeSlots=t)}},methods:{getSlotDate:w,getSlotTimeRange:k,formatToLocalDate(t){return t?l.utc(`${t.slot_start_time}`).local().format("ddd MMM D, YYYY"):""},formatToLocalTime(t){if(t){const e=l.utc(`${t.slot_start_time}`).local().format("h:mma"),s=l.utc(`${t.slot_end_time}`).local().format("h:mma");return`${e} - ${s}`}return""},async getTimeSlotsList(){this.loaderStatus=!0;const t=this.courseDetails.all_available_time_slots;this.availableTimeSlots=(t==null?void 0:t.length)>4?t.slice(0,4):t,this.loaderStatus=!1},dateConvert(t){const e=l.utc(`${t.slot_start_time}`).format("MMM DD"),s=l.utc(`${t.slot_end_time}`).format("MMM DD"),o=l.utc(`${t.slot_end_time}`).format("YYYY");return`${e}-${s}, ${o}`},timeConvert(t){const e=l.utc(`${t.slot_start_time}`).format("hh A"),s=l.utc(`${t.slot_end_time}`).format("hh A");return`${e} to ${s} ET`},getDateList(t){return this.dateConvert(t)},gettimeList(t){return this.timeConvert(t)},setSelectedDetails(){const{courseDetails:t,selectedSlotId:e,timeSlotsList:s}=this.operations;this.courseDetails={...t},this.availableTimeSlots=[...s],this.selectedSlotId=e},setCourseDetails(){const{courseDetails:t,listView:e,timeSlotsList:s}=this.operations;this.courseDetails={...t},e&&t?this.getTimeSlotsList():this.availableTimeSlots=[...s]},closeModal(){this.selectedSlotId=null,this.listView&&(this.availableTimeSlots=[]),C("#compliance-signup-modal").modal("hide")},async addCartOrUpdateSlot(){if(this.operations.type==="select"){const t={user_id:this.userId,plan_id:this.courseDetails.plan_id,ilt_slot_id:this.selectedSlotId};this.loaderStatus=!0;const e=await W(t);if(this.loaderStatus=!1,e.data&&e.data.status_code===200){this.closeModal();const s={type:"add",body:""};this.$emit("setCartInfo",{cartInfo:s,item:this.courseDetails}),this.emitter.emit("cart-items-updated")}}else if(this.operations.type==="edit"){this.loaderStatus=!0;const t={cart_id:this.courseDetails.cart_status.cart_id,course_id:this.courseDetails.course_id,new_slot_id:this.selectedSlotId,user_id:this.userId},e=await U(t);this.loaderStatus=!1,this.$emit("refreshAllInfo",e)}}}},m=t=>(V("data-v-6879c7ca"),t=t(),A(),t),E={id:"compliance-signup-modal",class:"modal",role:"dialog"},F={class:"modal-dialog modal-lg request-modal"},R={class:"modal-content col-xs-12 p-20"},q={key:0,class:"modal-header"},z={class:"col-xs-12 p-0 text-start header"},X=m(()=>a("img",{src:O,class:"lms-training-icon"},null,-1)),G={class:"modal-body"},H=m(()=>a("div",{class:"col-xs-12 course-time"},"Select your course time",-1)),J=m(()=>a("div",{class:"col-xs-9 text-regular-small text-secondary mb-20"}," Select a course time from the available list below. Once you select your course time and click on Add to account, you will be redirected to complete your purchase. ",-1)),K={class:"radio"},P=["value"],Q=m(()=>a("div",{class:"radio__radio"},null,-1)),Z={class:"pl-20"},tt={key:0,class:"col-xs-12 no-data-text text-center font-18 fw-700"},et={class:"footer col-xs-12 p-0 flex-wrapper"};function st(t,e,s,o,i,c){const f=v("BaseButton"),T=v("loader");return d(),n("div",E,[a("div",F,[a("div",R,[i.courseDetails?(d(),n("div",q,[a("div",z,[X,_(" "+u(i.courseDetails.title)+" ",1),a("img",{src:x,class:"close-icon",onClick:e[0]||(e[0]=(...r)=>c.closeModal&&c.closeModal(...r))})])])):g("",!0),a("div",G,[H,J,(d(!0),n(L,null,M(i.availableTimeSlots,(r,y)=>(d(),n("div",{class:"row col-xs-12",key:y},[a("div",{class:$(["col-xs-12 p-0 slot-card mb-15",{"selected-slot":i.selectedSlotId===r.slot_id}])},[a("label",K,[B(a("input",{type:"radio",class:"radio__input",value:r.slot_id,"onUpdate:modelValue":e[1]||(e[1]=b=>i.selectedSlotId=b)},null,8,P),[[Y,i.selectedSlotId]]),Q,a("div",Z,[a("div",null,u(c.getDateList(r)),1),a("div",null,u(c.gettimeList(r)),1)])])],2)]))),128)),!i.availableTimeSlots.length&&!this.loaderStatus?(d(),n("div",tt," More dates coming soon ")):g("",!0)]),a("div",et,[h(f,{onClick:c.closeModal,variant:"secondary"},{default:S(()=>[_(" Cancel ")]),_:1},8,["onClick"]),h(f,{class:"br-20 ml-20",disabled:c.eventsNone,onClick:c.addCartOrUpdateSlot},{default:S(()=>[_(u(s.operations.type==="select"?"Add to cart":"Update Slot"),1)]),_:1},8,["disabled","onClick"])]),h(T,{loadingStatus:i.loaderStatus},null,8,["loadingStatus"])])])])}const dt=D(j,[["render",st],["__scopeId","data-v-6879c7ca"]]);async function nt(t){let e={};return await p.get(`https://backend.opus.emergobyul.com/services/complianceWireTraining/courseList?userId=${t}`).then(s=>{s&&s.data.status_code===200&&(e=s.data.data)}).catch(s=>{console.log("get marketplace subscriptions api error",s)}),e}async function ut(t,e){let s={};return await p.get(`https://backend.opus.emergobyul.com/services/complianceWireTraining/courseList?planId=${t}&userId=${e}`).then(o=>{o&&o.data.status_code===200&&(s=o.data.data)}).catch(o=>{console.log("get marketplace subscriptions api error",o)}),s}async function mt(t){let e={};const s={courseId:t};return await p.get("https://backend.opus.emergobyul.com/services/complianceWireTraining/bookmark",{params:s}).then(o=>{o.status===200&&o.data&&(e=o.data)}).catch(o=>{e=o.response.data,console.log("ILT Latest Activity Api error",o)}),e}export{dt as T,mt as a,ut as b,nt as g};
