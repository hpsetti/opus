import{_ as D,o as i,c as l,a as s,t as r,n as v,F as I,m as x,B as F,d as C,r as g,k as d,I as b,w as y,b as h,p as k,f as w,$ as u}from"./index-BlMJxPGQ.js";import{c as M}from"./cloneDeep-ldw2ZiUo.js";import{O as P}from"./OpusSelect-BRceMwA4.js";import{A as V}from"./AddRemoveCartPopup-CqkASo7c.js";import{D as N}from"./DocumentsMoreInfo-CaOFYwEb.js";import{L as S}from"./Loader-DR0R9oEF.js";import{a as B,r as j}from"./cart-QHhiBhPv.js";import{c as E}from"./constants-DZfa7LnM.js";import{d as Y}from"./documentsMixin-Bh1uCigM.js";import"./event-bus-DYoA24Gz.js";import{p as G}from"./marketo-zx_g1DXt.js";import{c as q}from"./marketPlaceResources-hux66PHi.js";const U={props:{value:{type:String,default:"all"},tabs:{type:Object,default:()=>{}},tabCount:{type:Object,default:()=>{}}},methods:{setTab(a){this.value!==a&&this.$emit("input",a)}}},z={class:"horizontal-tabs d-flex p-0 mt-10"},Q=["onClick"];function Z(a,n,t,c,o,e){return i(),l("ul",z,[s("li",{onClick:n[0]||(n[0]=_=>e.setTab("all")),class:v(["cursor-pointer",{active:t.value==="all"}])}," All("+r(t.tabCount.all||0)+") ",3),(i(!0),l(I,null,x(t.tabs,(_,m)=>(i(),l("li",{onClick:f=>e.setTab(m),class:v(["cursor-pointer",{active:t.value===m}]),key:m},r(_)+" ("+r(t.tabCount[m]||0)+") ",11,Q))),128))])}const H=D(U,[["render",Z]]),J={mixins:[Y],props:{trainingDetails:{type:Object,default:()=>{}},type:{type:String,default:""},userId:{type:Number}},data(){return{loaderStatus:!1,notEnrolled:"Not Enrolled",cartInfo:{},cartStatus:E}},computed:{selectedTrainingInfo(){return this.trainingDetails[this.trainingDetails.plan_type]}},components:{Loader:S,BaseButton:F},methods:{navigateToTools(){this.$router.push("/tools/root-cause-analysis-wizard")},formatedDate(a){if(a){const[n,t]=a;return C(`${n}-${t}`).format("MMM YYYY")}return""},formatToLocalDate(a){return a?C.utc(`${a}`).local().format("ddd MMM DD , YYYY"):""},navigateToPreview(){const a=this.getQueryType(),n=this.trainingDetails[this.trainingDetails.plan_type].document_id;this.$router.push({path:`/market-place/documents/${n}`,query:{docType:a}})},downloadDocument(){this.downloadZipFile(this.trainingDetails[this.trainingDetails.plan_type].document_path)},getQueryType(){switch(this.trainingDetails.type){case"Use Environment Descriptions":return 3;case"User Profiles":return 2;default:return 1}},openCourseOrCertificate(){window.open(this.trainingDetails[this.trainingDetails.plan_type].deep_link,"_blank")},setSelectedTraining(a){const{plan_type:n}=this.trainingDetails,t=this.trainingDetails[this.trainingDetails.plan_type];if(["eLearning","Consulting"].includes(n)||this.trainingDetails.is_documents||this.trainingDetails.is_tools?this.$emit("setSelectedTrainingItem",{type:a,item:t,moduleType:this.getModuleType(t)}):n==="Instructor Led"&&this.$router.push({name:"ScheduleTraining",params:{id:t.course_id}}),this.trainingDetails.is_tools){const c={email:JSON.parse(localStorage.getItem("userData")).email,Last_Interest:"Human Factors Research & Design",page_urlextended:window.location.href,page_urlreferral_extended:document.referrer,form_control:"View",form_control_details:"View Premium RCA Details"};G(c)}},getModuleType(a){switch(!0){case a.is_tools:return"tools";case a.is_documents:return"documents";default:return"trainings"}},async addRemoveCart(a,n){const{purchase_status:t}=a.cart_status;if(t==="GO_TO_CART")this.$router.push("/market-place/cart");else if(t==="REMOVE_FROM_CART"){const c={type:"remove",body:"Are you sure you want to remove this item?"};this.$emit("setCartInfo",{cartInfo:c,item:this.trainingDetails[this.trainingDetails.plan_type]})}else if(t==="ADD_TO_CART"&&["eLearning","Consulting"].includes(this.trainingDetails.plan_type)||this.trainingDetails.is_documents||this.trainingDetails.is_tools){this.loaderStatus=!0;const c={user_id:this.userId,plan_id:n},o=await B(c);if(this.loaderStatus=!1,o.data&&o.data.status_code===200){const e={type:"add",body:""};this.$emit("setCartInfo",{cartInfo:e,item:this.trainingDetails[this.trainingDetails.plan_type]}),this.emitter.emit("cart-items-updated")}}else t==="ADD_TO_CART"&&this.trainingDetails.plan_type==="Instructor Led"&&this.$emit("onShowTimeSlots",this.trainingDetails)}}},p=a=>(k("data-v-d3bee722"),a=a(),w(),a),K={class:"col-xs-12 col-sm-8 col-md-7 p-0 d-flex col-gap-20 align-items-center"},W={class:"d-flex flex-direction-column col-xs-12 p-0"},X={class:"fw-300 text-primary mb-5 d-flex justify-content-between xs-flex-column"},$={key:0,class:"course-status fw-300 font-18"},ee={class:"fw-700 font-18 text-primary mb-10 d-flex justify-content-between xs-flex-column"},te={key:0,class:"course-status fw-300 font-18"},ae={key:0,class:"d-flex col-gap-30 xs-flex-column"},se={class:"d-flex align-items-center"},ne={class:"font-14 fw-300"},ie={class:"d-flex align-items-center"},oe={class:"font-14 fw-300"},le=p(()=>s("span",{class:"preview-text font-18 fw-600"},"Preview",-1)),re=[le],ce={key:1,class:"d-flex col-gap-30 xs-flex-column"},de=p(()=>s("div",{class:"d-flex align-items-start"},[s("span",{class:"font-14 fw-300"},"Online")],-1)),ue={class:"d-flex align-items-start"},_e={class:"font-14 fw-300"},me={class:"d-flex align-items-center"},fe={key:0},ge={key:1},he={key:2},pe={key:2,class:"d-flex col-gap-30 xs-flex-column"},Te=p(()=>s("span",{class:"preview-text font-18 fw-600"},"Preview",-1)),ve=[Te],ye={class:"col-xs-12 col-sm-4 col-md-5 p-0 d-flex flex-direction-column justify-content-center"},De={key:0,class:"col-xs-12 p-0 justify-end col-gap-20"},Ie={key:0},Ce={class:"col-xs-12 d-flex pl-0 justify-end col-gap-20"},be=p(()=>s("span",{class:"font-18 fw-700"},"Price",-1)),xe={class:"font-18 price-text text-strike"},ke={class:"col-xs-12 d-flex pl-0 justify-end col-gap-20"},we=p(()=>s("span",{class:"font-18 fw-700"},"Promotional Price",-1)),Se={class:"font-18 price-text"},Re={class:"mt-5 align-right mr-15"},Oe={key:1},Le={class:"col-xs-12 d-flex p-0 justify-end mb-20 col-gap-20"},Ae=p(()=>s("span",{class:"font-18 fw-700"},"Price",-1)),Fe={class:"font-18 price-text"},Me={class:"col-xs-12 d-flex col-gap-20 justify-content-end align-items-center p-0 cursor-pointer price"},Pe={key:0},Ve=p(()=>s("span",null,"Play course",-1)),Ne=p(()=>s("span",{class:"pl-10"},"Download",-1)),Be={key:3};function je(a,n,t,c,o,e){const _=g("BaseButton"),m=g("loader");return i(),l("div",{onClick:n[5]||(n[5]=f=>t.trainingDetails.is_tools&&e.selectedTrainingInfo.enrolled?e.navigateToTools():!1),class:v(["details-wrapper col-xs-12 p-10 mb-10 d-flex xs-flex-column",{"cart-item":t.type==="cart"||!e.selectedTrainingInfo.enrolled&&e.selectedTrainingInfo.cart_status.purchase_status==="GO_TO_CART","gray-out":t.trainingDetails&&e.selectedTrainingInfo.disable_as_bundle_added_to_cart,"cursor-pointer":t.trainingDetails.is_tools&&e.selectedTrainingInfo.enrolled}])},[s("div",K,[s("div",W,[s("div",X,[s("div",{class:v({"flex-50":t.trainingDetails.is_documents&&t.trainingDetails.plan_type!=="Templates"})},r(t.trainingDetails.plan_type),3),t.trainingDetails.is_documents&&t.trainingDetails.plan_type!=="Templates"?(i(),l("div",$,r(e.selectedTrainingInfo.category),1)):d("",!0)]),s("div",ee,[s("div",{class:v({"flex-50":e.selectedTrainingInfo.enrolled&&t.trainingDetails.is_trainings&&t.trainingDetails.type!=="Certificate"})},r(t.trainingDetails.plan_name),3),e.selectedTrainingInfo.enrolled&&t.trainingDetails.is_trainings&&t.trainingDetails.type!=="Certificate"?(i(),l("div",te,r(e.selectedTrainingInfo.course_status),1)):d("",!0)]),t.trainingDetails.plan_type==="eLearning"?(i(),l("div",ae,[s("div",se,[s("span",ne,r(e.selectedTrainingInfo.course_count)+" "+r(e.selectedTrainingInfo.course_count>1?"courses":"course"),1)]),s("div",ie,[s("span",oe,r(e.selectedTrainingInfo.duration_minutes)+" minutes",1)]),t.trainingDetails.type==="Course"&&t.trainingDetails.plan_type==="eLearning"&&e.selectedTrainingInfo.course_status===o.notEnrolled?(i(),l("div",{key:0,onClick:n[0]||(n[0]=f=>e.setSelectedTraining("video")),class:"d-flex align-items-center"},re)):d("",!0)])):t.trainingDetails.plan_type==="Instructor Led"?(i(),l("div",ce,[de,s("div",ue,[s("span",_e,r(e.selectedTrainingInfo.duration_hours)+" "+r(e.selectedTrainingInfo.duration_hours>1?"hours":"hour"),1)]),s("div",me,[e.selectedTrainingInfo.enrolled||t.trainingDetails.cart_id?(i(),l("div",fe,r(e.selectedTrainingInfo.booked_time_slot&&e.formatToLocalDate(e.selectedTrainingInfo.booked_time_slot.slot_start_time)||e.selectedTrainingInfo.booked_time_slot.slot_start_time),1)):!e.selectedTrainingInfo.enrolled&&e.selectedTrainingInfo.upcoming_time_slot?(i(),l("div",ge,r(e.selectedTrainingInfo.upcoming_time_slot.slot_start_time|e.formatToLocalDate),1)):(i(),l("div",he,"More dates coming soon"))])])):t.trainingDetails.is_documents&&!e.selectedTrainingInfo.is_bundle&&!e.selectedTrainingInfo.enrolled?(i(),l("div",pe,[s("div",{class:"d-flex align-items-start cursor-pointer",onClick:n[1]||(n[1]=f=>e.navigateToPreview())},ve)])):d("",!0)])]),s("div",ye,[t.trainingDetails.plan_type==="Instructor Led"||!e.selectedTrainingInfo.enrolled?(i(),l("div",De,[e.selectedTrainingInfo.discount_applicable?(i(),l("div",Ie,[s("div",Ce,[be,s("span",xe,"$"+r(t.trainingDetails.Tool.discount.price_before_discount),1)]),s("div",ke,[we,s("span",Se,"$"+r(t.trainingDetails.price),1)]),s("p",Re," Available until "+r(e.formatedDate(t.trainingDetails.Tool.discount.discount_valid_till)||t.trainingDetails.Tool.discount.discount_valid_till),1)])):(i(),l("div",Oe,[s("div",Le,[Ae,s("span",Fe,"$"+r(t.trainingDetails.price),1)])]))])):d("",!0),s("div",Me,[!e.selectedTrainingInfo.enrolled||t.trainingDetails.plan_type==="Instructor Led"?(i(),l("span",{key:0,class:"cursor-pointer font-18 fw-600",onClick:n[2]||(n[2]=f=>e.setSelectedTraining("more info"))},"View Details")):d("",!0),t.trainingDetails.is_trainings&&e.selectedTrainingInfo.enrolled&&t.trainingDetails.plan_type==="eLearning"?(i(),l(I,{key:1},[t.trainingDetails.type==="Certificate"?(i(),l("div",Pe)):t.trainingDetails.type!=="Certificate"?(i(),b(_,{key:1,"has-icon":"",class:"d-flex align-items-center col-gap-10",onClick:n[3]||(n[3]=f=>e.openCourseOrCertificate())},{default:y(()=>[Ve]),_:1})):d("",!0)],64)):d("",!0),t.trainingDetails.is_documents&&e.selectedTrainingInfo.enrolled?(i(),b(_,{key:2,onClick:e.downloadDocument,variant:"tertiary","has-icon":"",class:"d-flex align-items-center"},{default:y(()=>[Ne]),_:1},8,["onClick"])):d("",!0),e.selectedTrainingInfo.enrolled?d("",!0):(i(),l("div",Be,[h(_,{class:v(["br-20 d-flex align-items-center col-gap-10",{primary:e.selectedTrainingInfo.cart_status.purchase_status==="ADD_TO_CART",secondary:e.selectedTrainingInfo.cart_status.purchase_status==="REMOVE_FROM_CART",tertiary:e.selectedTrainingInfo.cart_status.purchase_status==="GO_TO_CART"}]),"has-icon":e.selectedTrainingInfo.cart_status.purchase_status==="GO_TO_CART",onClick:n[4]||(n[4]=f=>e.addRemoveCart(e.selectedTrainingInfo,t.trainingDetails.plan_id))},{default:y(()=>[s("span",null,r(o.cartStatus[e.selectedTrainingInfo.cart_status.purchase_status]),1)]),_:1},8,["has-icon","class"])]))])]),h(m,{loadingStatus:o.loaderStatus},null,8,["loadingStatus"])],2)}const Ee=D(J,[["render",je],["__scopeId","data-v-d3bee722"]]),Ye={props:{loader:{type:Boolean},userId:{type:Number,required:!0},toolName:{type:String,default:""}},data(){return{loaderStatus:!1,toolsData:{},cartInfo:{},documentInfo:{},selectedCartItem:{},activeTabName:{available:{id:0,name:"View all",no_of_documents:0,sequence:0}},trainingsData:{available:[{id:0,name:"View all",no_of_documents:0,sequence:0}]},filteredList:[],availableTabs:{},availableTabCount:{all:0}}},components:{AddRemoveCartPopup:V,OpusSelect:P,DocumentsInfo:N,TrainingDetails:Ee,Loader:S,Tabs:H},created(){this.getList()},methods:{closeAddRemoveCart(){u("#addRemoveCartPopup").modal("hide"),this.getList()},async removeFromCart(){u("#addRemoveCartPopup").modal("hide"),this.loaderStatus=!0;const a=await j(this.selectedCartItem.cart_status.cart_id);this.loaderStatus=!1,a.data&&a.data.status_code===200&&(u("#document-more-info").hasClass("in")&&u("#document-more-info").modal("hide"),this.$notify({type:a.data.message,title:"Success",text:a.data.data}),this.getList(),this.emitter.emit("cart-items-updated"))},setSelectedTrainingItem(a){this.selectedCartItem=a.item,u("#document-more-info").modal({backdrop:"static",keyboard:!1})},setCartInfo(a){this.cartInfo={...a.cartInfo},this.selectedCartItem=a.item,u("#document-more-info").hasClass("in")&&this.cartInfo.type==="add"&&u("#document-more-info").modal("hide"),u("#addRemoveCartPopup").modal({backdrop:"static",keyboard:!1})},async getList(){this.loaderStatus=!0,this.toolsData=await q(1,this.userId);const a=this.toolsData.item_list.filter(c=>this.toolName?c.plan_name===this.toolName:!0);this.toolsData=a;const t=M(this.toolsData).map(c=>(c.Tool.cart_status.purchase_status==="REMOVE_FROM_CART"&&(c.Tool.cart_status.purchase_status="GO_TO_CART"),c));this.toolsData=t,this.setCountForTabs(),this.loaderStatus=!1},setCountForTabs(){var n;const a=((n=this.toolsData)==null?void 0:n.length)||0;this.availableTabCount={all:a}},navigateToMarketplace(){this.$router.push("/market-place")},openMoreInfoPopup(a){this.documentInfo=a,u("#document-more-info").modal({backdrop:"static",keyboard:!1})},customLabel(a){return`${a.name} (${this.availableTabCount.all})`}}},Ge=a=>(k("data-v-06e2a762"),a=a(),w(),a),qe={class:"col-xs-12 p-0"},Ue={key:0,class:"opus-tools-header d-flex justify-content-between align-items-center xs-flex-column"},ze=Ge(()=>s("h2",{class:"text-h3 mb-0"},"Marketplace",-1)),Qe={style:{},class:"xs-width-100-650 opus-tools-select"},Ze={key:2,class:"col-xs-12 col-xs-12 text-center no-data-text font-22 fw-700 mt-20 mb-20"};function He(a,n,t,c,o,e){const _=g("tabs"),m=g("OpusSelect"),f=g("training-details"),R=g("add-remove-cart-popup"),O=g("loader"),L=g("documents-info");return i(),l("div",qe,[h(_,{modelValue:o.activeTabName,"onUpdate:modelValue":n[0]||(n[0]=T=>o.activeTabName=T),tabs:o.availableTabs,tabCount:o.availableTabCount},null,8,["modelValue","tabs","tabCount"]),this.$route.path==="/tools"?(i(),l("div",Ue,[ze,s("div",Qe,[h(m,{class:"opusToolsSelect",modelValue:o.activeTabName.available,"onUpdate:modelValue":n[1]||(n[1]=T=>o.activeTabName.available=T),options:o.trainingsData.available,trackBy:"id","custom-label":e.customLabel},null,8,["modelValue","options","custom-label"])])])):d("",!0),o.toolsData&&o.toolsData.length?(i(!0),l(I,{key:1},x(o.toolsData,T=>(i(),l("div",{class:"col-xs-12 p-0",key:`${T.plan_id}`},[h(f,{onSetSelectedTrainingItem:e.setSelectedTrainingItem,onSetCartInfo:n[2]||(n[2]=A=>e.setCartInfo(A,"tools")),userId:t.userId,trainingDetails:T,onRemoveFromCart:e.removeFromCart},null,8,["onSetSelectedTrainingItem","userId","trainingDetails","onRemoveFromCart"])]))),128)):o.toolsData&&!o.toolsData.length&&!o.loaderStatus?(i(),l("div",Ze," You have purchased all the tools ")):d("",!0),h(R,{onCloseAddRemoveCart:e.closeAddRemoveCart,cartInfo:o.cartInfo,onRemoveFromCart:e.removeFromCart},null,8,["onCloseAddRemoveCart","cartInfo","onRemoveFromCart"]),h(O,{loadingStatus:o.loaderStatus},null,8,["loadingStatus"]),h(L,{isRca:!0,loader:o.loaderStatus,templateInfo:o.selectedCartItem,userId:t.userId,onSetCartInfo:e.setCartInfo,moduleType:"tools"},null,8,["loader","templateInfo","userId","onSetCartInfo"])])}const lt=D(Ye,[["render",He],["__scopeId","data-v-06e2a762"]]);export{lt as m};
