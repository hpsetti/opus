import{_ as j,d as a,H as S,s as q,B as T,c as n,a as t,t as r,b as u,k as m,F as I,m as w,j as h,v as f,w as y,r as D,o as d,Y as C,e as c,p as k,f as Y}from"./index-BlMJxPGQ.js";import{i as L}from"./index.es-Cl9EeDOg.js";import{L as P}from"./Loader-DR0R9oEF.js";import{b as U,c as V,u as M}from"./consultingAdmin-BYUi1mkh.js";import{_ as B}from"./back_arrow-DlGi0Dam.js";const F="/static/images/consulting/edit.svg";a.extend(S);const O={props:{activeProjectList:{type:Array,default:()=>[]},consultingProjectType:{type:String,default:()=>""}},data(){return{loaderStatus:!1,projectId:null,enableButton:!1,startTime:"",payment_received_date:"",endTime:"",completedDate:"",UTCFormat:"DD-MMM-YYYY",dateCheckFormat:"DD-MM-YYYY",defaultEndTime:"",defaultStartTime:"",setProjectStatus:null,projectDetails:null,projectStatusList:[],accountId:null,requestedUserId:null,requestedAccountId:null,formDetails:{account_id:"",account_owner_id:"",comments:"",invoice:"",purchase_order:"",payment_mode:null,requested_status_id:null,paid_price:0},paymentStatusList:[{id:0,status_type:"Pending"},{id:1,status_type:"Completed"}],paymentOptions:[{id:2,name:"Invoice"},{id:3,name:"Purchase Order"},{id:4,name:"Others"}]}},components:{Multiselect:q,DatePicker:L,Loader:P,BaseButton:T},async created(){this.projectId=+this.$route.params.id,this.accountId=JSON.parse(localStorage.getItem("userId")),await this.getprojectsById()},computed:{canSave(){return this.formDetails.requested_status_id===2&&this.formDetails.payment_mode===2&&this.formDetails.invoice!==""||this.formDetails.requested_status_id===2&&this.formDetails.payment_mode===3&&this.formDetails.purchase_order!==""||this.formDetails.requested_status_id===2&&this.formDetails.payment_mode===4||this.formDetails.requested_status_id===3&&this.completedDate!==""&&this.completedDate!==null}},methods:{navigateToLaunchPad(){this.$router.go(-1)},formatToHumanDate(i){return a.utc(`${i}`).local().format("DD-MMM-YYYY")},async getprojectsById(){this.loaderStatus=!0,this.projectDetails=await U(this.projectId),this.projectStatusList=await V(),this.startTime=a(this.projectDetails.requested_date).format(this.UTCFormat),this.endTime=a(this.projectDetails.modified_date).format(this.UTCFormat),this.projectDetails.completion_date!=="null"&&(this.completedDate=a(this.projectDetails.completion_date).format(this.UTCFormat)),this.requestedAccountId=this.projectDetails.request_account_id.account_id,this.requestedUserId=this.projectDetails.request_account_id.user_id;const i=this.projectStatusList.find(l=>l.status_type===this.projectDetails.consulting_status);this.projectDetails.payment_received?this.formDetails.payment_received=1:this.formDetails.payment_received=0,this.formDetails={...this.formDetails,requested_status_id:i.id},this.loaderStatus=!1},clearForm(){this.formDetails={account_id:"",account_owner_id:"",comments:"",invoice:"",purchase_order:"",payment_mode:null,requested_status_id:null,paid_price:0}},async cancelStatus(){await this.getprojectsById(),this.clearForm()},async updatePaymentStatus(){if(this.formDetails.requested_status_id===3){const l=a(a(this.completedDate).toLocaleString()).utc().add(1,"days").format("YYYY-MM-DDTHH:mm:ss.SSS[Z]");this.formDetails={plan_add_admin_request:{account_id:this.requestedAccountId,account_owner_id:this.requestedAccountId,comments:this.formDetails.comments,invoice:this.formDetails.invoice,purchase_order:this.formDetails.purchase_order,payment_mode:this.formDetails.payment_mode,plan_price:+this.formDetails.paid_price,user_id:this.requestedUserId,plan_info_list:[{ilt_slot_id:0,plan_id:this.projectDetails.plan_id}]},payment_received:this.formDetails.payment_received,payment_received_date:a(a(this.formDetails.payment_received_date).toLocaleString()).utc().format("YYYY-MM-DDTHH:mm:ss.SSS[Z]"),consulting_id:this.projectDetails.consulting_user_info_id,plan_id:this.projectDetails.plan_id,requested_status_id:this.formDetails.requested_status_id,completion_date:l}}else this.formDetails={plan_add_admin_request:{account_id:this.requestedAccountId,account_owner_id:this.requestedAccountId,comments:this.formDetails.comments,invoice:this.formDetails.invoice,purchase_order:this.formDetails.purchase_order,payment_mode:this.formDetails.payment_mode,plan_price:+this.formDetails.paid_price,user_id:this.requestedUserId,plan_info_list:[{ilt_slot_id:0,plan_id:this.projectDetails.plan_id}]},payment_received:this.formDetails.payment_received,payment_received_date:a(a(this.formDetails.payment_received_date).toLocaleString()).utc().format("YYYY-MM-DDTHH:mm:ss.SSS[Z]"),consulting_id:this.projectDetails.consulting_user_info_id,plan_id:this.projectDetails.plan_id,requested_status_id:this.formDetails.requested_status_id};const i=await M(this.formDetails);i.message==="warning"?this.$notify({type:"warning",title:"Warning",text:i.data}):i.message==="success"?this.$notify({type:"success",title:"Success",text:i.data}):this.$notify({type:"error",title:"Error",text:i.data}),this.getprojectsById()},editProject(i){const{type:l}=this.$route.params;this.$router.push({path:`/launchpad/consulting-hours/projects/${l}/edit/${i}`})},selectedStartDate(){this.startTime?this.defaultEndTime=a(a(this.startTime).format(this.UTCFormat)).valueOf()+1e3*61:this.startTime||(this.endTime="",this.defaultStartTime=this.createDefaultStartTime())}}},s=i=>(k("data-v-13965b26"),i=i(),Y(),i),H={key:0},E={class:"col-xs-12 mt-20 p-0"},A={class:"col-xs-12 search-header"},N=s(()=>t("img",{class:"back-img cursor-pointer",src:B,alt:""},null,-1)),X=s(()=>t("p",{class:"text-subtitle-2 blue-1 pt-10",to:"/launchpad"}," Consulting Hours ",-1)),Z=[N,X],R={class:"row pl-20"},J={class:"col-xs-10"},W={class:"text-h5"},z=s(()=>t("img",{class:"back-img",src:F,alt:""},null,-1)),G=s(()=>t("p",{class:"text-subtitle-1 pt-10 pl-5 blue-3"},"Edit",-1)),K=[z,G],Q={class:"row pl-20"},$={class:"col-xs-12 d-flex"},tt=s(()=>t("p",{class:"col-xs-2 text-button-label pl-0"},[c(" Device Type"),t("span",null,": ")],-1)),et={class:"col-xs-10 text-regular-large pl-60"},st={class:"col-xs-12 d-flex"},ot=s(()=>t("p",{class:"col-xs-2 text-button-label pl-0"},[c("User"),t("span",null,": ")],-1)),lt={class:"col-xs-10 text-regular-large pl-60"},it={class:"col-xs-12 d-flex"},at=s(()=>t("p",{class:"col-xs-2 text-button-label pl-0"},[c(" Email"),t("span",null,": ")],-1)),ct={class:"col-xs-10 text-regular-large pl-60"},rt={class:"col-xs-12 d-flex"},nt=s(()=>t("p",{class:"col-xs-2 text-button-label pl-0"},[c(" Company"),t("span",null,": ")],-1)),dt={class:"col-xs-10 text-regular-large pl-60"},_t=s(()=>t("hr",null,null,-1)),ut=s(()=>t("div",{class:"row pl-20"},[t("div",{class:"col-xs-10"},[t("p",{class:"text-h4"},"Project Info")])],-1)),pt={class:"row pl-20"},mt={class:"col-xs-12 d-flex"},ht=s(()=>t("p",{class:"col-xs-2 text-button-label pl-0"},[c("Type"),t("span",null,": ")],-1)),ft={class:"col-xs-10 text-regular-large pl-60"},Dt={class:"col-xs-12 d-flex"},vt=s(()=>t("p",{class:"col-xs-2 text-button-label pl-0"},[c(" Service"),t("span",null,": ")],-1)),xt={class:"col-xs-10 text-regular-large pl-60"},yt={class:"col-xs-12 d-flex"},gt=s(()=>t("p",{class:"col-xs-2 text-button-label pl-0"},[c(" Requested Date"),t("span",null,": ")],-1)),bt={class:"col-xs-10 text-regular-large pl-60"},jt={class:"col-xs-12 d-flex"},St=s(()=>t("p",{class:"col-xs-2 text-button-label pl-0"},[c(" Last modified"),t("span",null,": ")],-1)),qt={class:"col-xs-10 text-regular-large pl-60"},Tt={class:"col-xs-12"},It=s(()=>t("p",{class:"text-button-label pl-0"},[c(" Other details:"),t("span",null,": ")],-1)),wt={class:"text-regular-large pr-20"},Ct=s(()=>t("hr",null,null,-1)),kt={class:"row"},Yt={key:0,class:"col-xs-12 col-sm-4 select"},Lt=s(()=>t("label",null,"Consulting Status",-1)),Pt=s(()=>t("span",{style:{color:"red"}},"*",-1)),Ut={key:1,class:"col-xs-12 col-sm-4 select"},Vt=s(()=>t("label",null,"Payment Status",-1)),Mt=s(()=>t("span",{style:{color:"red"}},"*",-1)),Bt={key:2,class:"col-xs-12 mt-20 mb-10"},Ft=s(()=>t("div",{class:"col-xs-12 p-0"},[c(" Payment Options "),t("span",{class:"required-asterisk"},"*")],-1)),Ot={class:"radio"},Ht=["value"],Et=s(()=>t("div",{class:"radio__radio"},null,-1)),At={class:"font-18 text-primary"},Nt={key:0,class:"col-xs-12 col-sm-4 mb-20 p-0"},Xt=s(()=>t("label",null,"Invoice Details",-1)),Zt=s(()=>t("span",{class:"required-asterisk"},"*",-1)),Rt={key:1,class:"col-xs-12 col-sm-4 mb-20 p-0"},Jt=s(()=>t("label",null,"Purchase Order Details",-1)),Wt=s(()=>t("span",{class:"required-asterisk"},"*",-1)),zt={class:"col-xs-12 p-0"},Gt={class:"col-xs-12 col-sm-4 mt-20 mb-20 p-0"},Kt=s(()=>t("label",null,"Total Price",-1)),Qt={class:"col-xs-12 p-0"},$t={class:"col-xs-12 col-sm-4 p-0"},te=s(()=>t("label",null,"Comments",-1)),ee={class:"row pb-40 mb-30"},se={class:"col-xs-12 col-sm-4 select mb-30"},oe=s(()=>t("label",null,"Completion date",-1)),le=s(()=>t("span",{style:{color:"red"}},"*",-1)),ie={class:"row p-20 d-flex col-gap-10 justify-content-end cart-footer"};function ae(i,l,ce,re,e,_){const v=D("multiselect"),g=D("date-picker"),x=D("BaseButton"),b=D("loader");return e.projectDetails?(d(),n("div",H,[t("div",E,[t("div",A,[t("div",{class:"col-xs-12 mb-10 d-flex align-items-center col-gap-10 mb-20 pl-20",onClick:l[0]||(l[0]=(...o)=>_.navigateToLaunchPad&&_.navigateToLaunchPad(...o))},Z),t("div",null,[t("div",R,[t("div",J,[t("p",W,r(e.projectDetails.project_name),1)]),t("div",{class:"col-xs-2 d-flex cursor-pointer",onClick:l[1]||(l[1]=o=>_.editProject(e.projectId))},K)]),t("div",Q,[t("div",$,[tt,t("p",et,r(e.projectDetails.device_type),1)]),t("div",st,[ot,t("p",lt,r(e.projectDetails.user_name),1)]),t("div",it,[at,t("p",ct,r(e.projectDetails.email_address),1)]),t("div",rt,[nt,t("p",dt,r(e.projectDetails.company_name),1)])])]),_t,t("div",null,[ut,t("div",pt,[t("div",mt,[ht,t("p",ft,r(e.projectDetails.consulting_type),1)]),t("div",Dt,[vt,t("p",xt,r(e.projectDetails.consulting_name),1)]),t("div",yt,[gt,t("p",bt,r(e.startTime),1)]),t("div",jt,[St,t("p",qt,r(e.endTime),1)]),t("div",Tt,[It,t("p",wt,r(e.projectDetails.other_details),1)])])]),Ct,t("div",kt,[e.formDetails?(d(),n("div",Yt,[Lt,Pt,u(v,{showLabels:!1,"close-on-select":!0,"allow-empty":!1,class:"multiselect-single-dropdown",options:e.projectStatusList.map(o=>o.id),"custom-label":o=>e.projectStatusList.find(p=>p.id==o).status_type,modelValue:e.formDetails.requested_status_id,"onUpdate:modelValue":l[2]||(l[2]=o=>e.formDetails.requested_status_id=o)},null,8,["options","custom-label","modelValue"])])):m("",!0),[2,3].includes(e.formDetails.requested_status_id)?(d(),n("div",Ut,[Vt,Mt,u(v,{showLabels:!1,"close-on-select":!0,"allow-empty":!1,class:"multiselect-single-dropdown",disabled:!!e.projectDetails.payment_received,options:e.paymentStatusList.map(o=>o.id),"custom-label":o=>e.paymentStatusList.find(p=>p.id==o).status_type,modelValue:e.formDetails.payment_received,"onUpdate:modelValue":l[3]||(l[3]=o=>e.formDetails.payment_received=o)},null,8,["disabled","options","custom-label","modelValue"])])):m("",!0),e.formDetails.requested_status_id===2&&!e.projectDetails.payment_request_sent?(d(),n("div",Bt,[Ft,(d(!0),n(I,null,w(e.paymentOptions,o=>(d(),n("div",{class:"col-xs-12 col-sm-3",key:o.id},[t("label",Ot,[h(t("input",{type:"radio",class:"radio__input",value:o.id,"onUpdate:modelValue":l[4]||(l[4]=p=>e.formDetails.payment_mode=p)},null,8,Ht),[[C,e.formDetails.payment_mode]]),Et,t("div",At,r(o.name),1)])]))),128)),e.formDetails.payment_mode===2?(d(),n("div",Nt,[Xt,Zt,h(t("input",{maxlength:"65",class:"form-control",type:"text","onUpdate:modelValue":l[5]||(l[5]=o=>e.formDetails.invoice=o),placeholder:"Enter Invoice ID"},null,512),[[f,e.formDetails.invoice,void 0,{trim:!0}]])])):e.formDetails.payment_mode===3?(d(),n("div",Rt,[Jt,Wt,h(t("input",{maxlength:"65",class:"form-control",type:"text","onUpdate:modelValue":l[6]||(l[6]=o=>e.formDetails.purchase_order=o),placeholder:"Enter Purchase Order ID"},null,512),[[f,e.formDetails.purchase_order,void 0,{trim:!0}]])])):m("",!0),t("div",zt,[t("div",Gt,[Kt,h(t("input",{class:"form-control",type:"number","onUpdate:modelValue":l[7]||(l[7]=o=>e.formDetails.paid_price=o)},null,512),[[f,e.formDetails.paid_price,void 0,{trim:!0}]])])]),t("div",Qt,[t("div",$t,[te,h(t("textarea",{maxlength:"1500",type:"text",class:"form-control comments",rows:"5","onUpdate:modelValue":l[8]||(l[8]=o=>e.formDetails.comments=o)},null,512),[[f,e.formDetails.comments,void 0,{trim:!0}]])])])])):m("",!0)]),t("div",ee,[t("div",se,[oe,le,u(g,{modelValue:e.completedDate,"onUpdate:modelValue":l[9]||(l[9]=o=>e.completedDate=o),type:"date",lang:"en","value-type":"format",format:e.UTCFormat,placeholder:"XX-Month-XXXX",onChange:l[10]||(l[10]=o=>_.selectedStartDate()),disabled:!(e.formDetails.requested_status_id===3&&!this.projectDetails.project_completed)},null,8,["modelValue","format","disabled"])])]),t("div",ie,[u(x,{variant:"secondary",onClick:_.cancelStatus},{default:y(()=>[c("Cancel")]),_:1},8,["onClick"]),u(x,{onClick:_.updatePaymentStatus,disabled:!_.canSave},{default:y(()=>[c("Save Changes")]),_:1},8,["onClick","disabled"])])]),u(b,{loadingStatus:e.loaderStatus},null,8,["loadingStatus"])])])):m("",!0)}const me=j(O,[["render",ae],["__scopeId","data-v-13965b26"]]);export{me as default};
