import{_ as b,B as I,d as u,W as D,X as T,$ as x,o as d,c as r,a as e,e as m,t as c,O as C,k as p,F as w,m as k,n as B,j as L,Y as M,b as _,w as S,r as f,p as V,f as N}from"./index-BlMJxPGQ.js";import{L as U}from"./Loader-DR0R9oEF.js";import{a as Y}from"./cart-QHhiBhPv.js";import{b as O,u as F}from"./instructorLedTraining-DE_vpi5U.js";import"./event-bus-DYoA24Gz.js";import{_ as R}from"./info-modal-training-icon-Dm7yAfS1.js";const j={props:["listView","timeSlotsList","userId","operations"],data(){return{courseDetails:{},loaderStatus:!1,selectedSlotId:null,availableTimeSlots:[]}},components:{Loader:U,BaseButton:I},computed:{eventsNone(){return this.operations.type==="select"?!this.selectedSlotId:this.selectedSlotId===this.operations.selectedSlotId}},watch:{operations:{handler(t){t.type==="select"?this.setCourseDetails():t.type==="edit"&&this.setSelectedDetails()},deep:!0},timeSlotsList(t){t&&(this.availableTimeSlots=t)}},filters:{formatToLocalDate(t){return t?u.utc(`${t.slot_start_time}`).local().format("ddd MMM D, YYYY"):""},formatToLocalTime(t){if(t){const s=u.utc(`${t.slot_start_time}`).local().format("h:mma"),o=u.utc(`${t.slot_end_time}`).local().format("h:mma");return`${s} - ${o}`}return""}},methods:{getSlotDate:D,getSlotTimeRange:T,async getTimeSlotsList(){this.loaderStatus=!0;const t=await O(this.courseDetails.course_id);this.availableTimeSlots=(t==null?void 0:t.length)>4?t.slice(0,4):t,this.loaderStatus=!1},setSelectedDetails(){const{courseDetails:t,selectedSlotId:s,timeSlotsList:o}=this.operations;this.courseDetails={...t},this.availableTimeSlots=[...o],this.selectedSlotId=s},setCourseDetails(){const{courseDetails:t,listView:s,timeSlotsList:o}=this.operations;this.courseDetails={...t},s&&t?this.getTimeSlotsList():this.availableTimeSlots=[...o]},closeModal(){this.selectedSlotId=null,this.listView&&(this.availableTimeSlots=[]),x("#training-signup-modal").modal("hide")},async addCartOrUpdateSlot(){if(this.operations.type==="select"){const t={user_id:this.userId,plan_id:this.courseDetails.plan_id,ilt_slot_id:this.selectedSlotId};this.loaderStatus=!0;const s=await Y(t);if(this.loaderStatus=!1,s.data&&s.data.status_code===200){this.closeModal();const o={type:"add",body:""};this.$emit("setCartInfo",{cartInfo:o,item:this.courseDetails}),this.emitter.emit("cart-items-updated")}}else if(this.operations.type==="edit"){this.loaderStatus=!0;const t={cart_id:this.courseDetails.cart_status.cart_id,course_id:this.courseDetails.course_id,new_slot_id:this.selectedSlotId,user_id:this.userId},s=await F(t);this.loaderStatus=!1,this.$emit("refreshAllInfo",s)}}}},n=t=>(V("data-v-b3c501c0"),t=t(),N(),t),A={id:"training-signup-modal",class:"modal",role:"dialog"},q={class:"modal-dialog modal-lg request-modal"},z={class:"modal-content col-xs-12 p-20"},E={key:0,class:"modal-header"},W={class:"col-xs-12 p-0 text-start header"},X=n(()=>e("img",{src:R,class:"lms-training-icon"},null,-1)),G={class:"modal-body"},H=n(()=>e("div",{class:"col-xs-12 course-time"},"Select your course time",-1)),J=n(()=>e("div",{class:"col-xs-9 text-regular-small text-secondary mb-20"}," Select a course time from the available list below. Once you select your course time and click on Add to account, you will be redirected to the marketplace to complete your purchase. ",-1)),K={class:"radio"},P=["value"],Q=n(()=>e("div",{class:"radio__radio"},null,-1)),Z={class:"pl-20"},$={key:0,class:"col-xs-12 no-data-text text-center font-18 fw-700"},tt={class:"footer col-xs-12 p-0 flex-wrapper"};function et(t,s,o,st,a,l){const h=f("BaseButton"),v=f("loader");return d(),r("div",A,[e("div",q,[e("div",z,[a.courseDetails?(d(),r("div",E,[e("div",W,[X,m(" "+c(a.courseDetails.title)+" ",1),e("img",{src:C,class:"close-icon",onClick:s[0]||(s[0]=(...i)=>l.closeModal&&l.closeModal(...i))})])])):p("",!0),e("div",G,[H,J,(d(!0),r(w,null,k(a.availableTimeSlots,(i,g)=>(d(),r("div",{class:"row col-xs-12",key:g},[e("div",{class:B(["col-xs-12 p-0 slot-card mb-15",{"selected-slot":a.selectedSlotId===i.slot_id}])},[e("label",K,[L(e("input",{type:"radio",class:"radio__input",value:i.slot_id,"onUpdate:modelValue":s[1]||(s[1]=y=>a.selectedSlotId=y)},null,8,P),[[M,a.selectedSlotId]]),Q,e("div",Z,[e("div",null,c(l.getSlotDate(i)),1),e("div",null,c(l.getSlotTimeRange(i)),1)])])],2)]))),128)),!a.availableTimeSlots.length&&!this.loaderStatus?(d(),r("div",$," More dates coming soon ")):p("",!0)]),e("div",tt,[_(h,{onClick:l.closeModal,variant:"secondary"},{default:S(()=>[m(" Cancel ")]),_:1},8,["onClick"]),_(h,{class:"br-20 ml-20",disabled:l.eventsNone,onClick:l.addCartOrUpdateSlot},{default:S(()=>[m(c(o.operations.type==="select"?"Add to cart":"Update Slot"),1)]),_:1},8,["disabled","onClick"])]),_(v,{loadingStatus:a.loaderStatus},null,8,["loadingStatus"])])])])}const ct=b(j,[["render",et],["__scopeId","data-v-b3c501c0"]]);export{ct as T};
