import{b0 as O,b1 as V,am as N,z as $,_ as v,B as q,r as g,o as _,c as h,a as t,b as m,w as S,e as p,p as b,f as P,O as E,d as C,$ as w,j as f,v as F,b2 as U,t as d,n as u,q as T,F as M,m as Y,k as x,I as H}from"./index-BlMJxPGQ.js";import{o as R,_ as z}from"./edit_icon_new-D9iwJqyt.js";import{_ as G}from"./_baseAssignValue-BD6sbZ4C.js";import{T as J}from"./Tabs-BjvU5MJa.js";import{p as B,d as Q}from"./consultingAdmin-BYUi1mkh.js";import{L as W}from"./Loader-DR0R9oEF.js";import{P as X}from"./Pagination-BZVaeVs8.js";import{_ as Z}from"./search_icon-C65g3Q5L.js";import{_ as tt}from"./delete-Czt7tnOC.js";import{_ as et}from"./delete_icon-WtjTFUCM.js";import{_ as st}from"./back_arrow-DlGi0Dam.js";import"./chevron_right-Bv87NFTl.js";function ot(s,e,n,c){for(var o=-1,a=s==null?0:s.length;++o<a;){var i=s[o];e(c,i,n(i),s)}return c}var at=ot,rt=O;function nt(s,e,n,c){return rt(s,function(o,a,i){e(c,o,n(o),i)}),c}var ct=nt,lt=at,it=ct,dt=V,ut=N;function pt(s,e){return function(n,c){var o=ut(n)?lt:it,a=e?e():{};return o(n,s,dt(c),a)}}var _t=pt,gt=G,ht=_t,mt=Object.prototype,yt=mt.hasOwnProperty,jt=ht(function(s,e,n){yt.call(s,n)?s[n].push(e):gt(s,n,[e])}),ft=jt;const k=$(ft),vt={props:["userId"],data(){return{}},components:{BaseButton:q},methods:{async publishDelete(){this.$emit("deleteConsultantProject")}}},A=s=>(b("data-v-f958818f"),s=s(),P(),s),bt={id:"modal_project_delete",class:"modal",role:"dialog"},Pt={class:"modal-dialog modal-lg"},St={class:"modal-content"},Ct=A(()=>t("div",{class:"modal-header"},[t("div",{class:"d-flex justify-content-between float-right"},[t("img",{"data-dismiss":"modal",class:"cursor-pointer",src:E,alt:""})])],-1)),wt={class:"modal-body"},Tt=A(()=>t("div",{class:"center pb-10"},[t("p",{class:"text-h4 pb-10"}," Are you sure you want to delete this project? "),t("p",{class:"text-regular-large"}," Deleting project(s) will remove it permanently from the database. ")],-1)),xt={class:"d-flex justify-content-center p-0 mt-20 col-gap-50 mb-20"};function Bt(s,e,n,c,o,a){const i=g("BaseButton");return _(),h("div",null,[t("div",bt,[t("div",Pt,[t("div",St,[Ct,t("div",wt,[Tt,t("div",xt,[m(i,{"data-dismiss":"modal",variant:"secondary"},{default:S(()=>[p("Cancel")]),_:1}),m(i,{variant:"error",onClick:e[0]||(e[0]=j=>a.publishDelete())},{default:S(()=>[p("Yes, Delete")]),_:1})])])])])])])}const kt=v(vt,[["render",Bt],["__scopeId","data-v-f958818f"]]),At="/static/images/icons/menu_dots.svg",Dt="/static/images/icons/document_black.svg",It={name:"ConsultingProjectsTable",components:{Tabs:J,deleteProject:kt,Loader:W,Pagination:X},props:{projectTabs:{type:Object,default:()=>{}},projectCategories:{type:Object,default:()=>{}},consultingProjectType:{type:String,default:()=>""}},data(){return{loaderStatus:!1,groupByStatus:{},selectedProjects:[],selectedProject:[],startTime:"",endTime:"",UTCFormat:"DD-MMM-YYYY",isSelectAll:!1,activeTabName:"all",projectId:null,activeProjectList:[],projectSearchKeyword:"",filteredProjects:{},projectTabCount:{Requested:"Requested",Inprogress:"Inprogress",Completed:"Completed"},orderBy:{name:"asc",type:"asc"},sortBy:"title",sortOrder:"asc",sortingType:"name",sortingOrder:"asc",sortIcon:"asc",selectedSortColumn:"title",totalPages:0,currentPage:1,perPage:20,total:0,searchView:!1,sortOptions:{project_name:1,consulting_name:-1,email_address:-1,modified_date:-1,requested_date:-1,consulting_status:-1}}},async created(){await this.getProjectListByType(),this.setSortBy("project_name")},methods:{onSelectAll(){this.isSelectAll=this.selectedProjects.length===this.groupByStatus[this.activeTabName].length},deSelectAll(){this.selectedProjects=[],this.isSelectAll=!1},setAllSelected(){this.isSelectAll?this.selectedProjects=this.groupByStatus[this.activeTabName].map(s=>s.consulting_user_info_id):this.selectedProjects=[]},async getProjectListByType(){const s={consulting_type:this.consultingProjectType,pagination:{current_page:this.currentPage,result_per_page:this.perPage},search:""},e=await B(s),n=e.result_data;this.totalPages=e.total_pages,this.total=e.total_records_count;const c=n.filter(o=>o.active===!0);this.activeProjectList=c.map(o=>{const a={...o};return a.requested_date=C(this.groupByStatus.requested_date).format(this.UTCFormat),a.modified_date=C(this.groupByStatus.modified_date).format(this.UTCFormat),a}),this.groupByStatus=k(this.activeProjectList,o=>o.consulting_status),this.groupByStatus.all=this.activeProjectList},async getprojectSearchKeyword(){this.searchView||(this.currentPage=1);const s={consulting_type:this.consultingProjectType,pagination:{current_page:this.currentPage,result_per_page:this.perPage},search:this.projectSearchKeyword},e=await B(s);this.totalPages=e.total_pages,this.total=e.total_records_count,this.searchView=!!this.projectSearchKeyword,this.activeProjectList=e.result_data,this.groupByStatus=k(this.activeProjectList,n=>n.consulting_status),this.groupByStatus.all=this.activeProjectList},async pagechanged(s){this.loaderStatus=!0,this.currentPage=s,this.projectSearchKeyword?await this.getprojectSearchKeyword():await this.getProjectListByType(),this.loaderStatus=!1},viewProject(s){this.$router.push({path:`${this.$route.path}view/${s}`})},editProject(s){const{type:e}=this.$route.params;this.$router.push({path:`/launchpad/consulting-hours/projects/${e}/edit/${s}`})},deletepopup(s=!1,e){s?this.selectedProject=[]:this.selectedProject=[e],w("#modal_project_delete").modal({backdrop:"static",keyboard:!1})},async deleteProject(){w("#modal_project_delete").modal("hide");const s=this.selectedProject.length?this.selectedProject:this.selectedProjects;this.loaderStatus=!0;const n=await Q({ids:s});this.loaderStatus=!1,n?this.$notify({type:"success",title:"Success",text:"Project deleted successfully!"}):this.$notify({type:"error",title:"Error",text:"Please try again later!"}),this.isSelectAll=!1,this.getProjectListByType()},getSortKey(s){let e="";return e+=this.sortOptions[s]>0?"asc":"desc",e+=this.sortingType===s?" active":" ",e},setSortBy(s){const e=this.groupByStatus[this.activeTabName];this.sortingType=s,this.sortOptions[s]*=-1;const n=this.sortOptions[s]>0?"desc":"asc";this.sortIcon=n;const c=R(e,s,n);this.groupByStatus={...this.groupByStatus,[this.activeTabName]:c}}}},l=s=>(b("data-v-09f0317f"),s=s(),P(),s),Kt={class:"col-xs-12 p-0 search-wrapper"},Lt={class:"form-group search-container pl-10 pr-10 cursor-pointer"},Ot=l(()=>t("img",{src:Z,alt:""},null,-1)),Vt={class:"col-xs-12 p-0 pl-10 mt-10 d-flex align-items-center justify-content-between flex-wrap"},Nt={class:"items-count"},$t={class:"d-flex"},qt=l(()=>t("img",{class:"back-img gap-nve-5",src:tt,alt:""},null,-1)),Et=l(()=>t("span",null,"Delete",-1)),Ft=[qt,Et],Ut={class:"col-xs-12 p-0"},Mt={class:"col-xs-12 p-0 pl-10 pr-10"},Yt={key:0,class:"projects-table"},Ht={class:"pl-5 pr-10"},Rt={class:"select-box"},zt={class:"checkbox"},Gt=l(()=>t("span",{class:"cr"},[t("i",{class:"cr-icon glyphicon glyphicon-ok"})],-1)),Jt={class:"pl-5 pr-10 select-checkbox"},Qt={class:"select-box"},Wt={class:"checkbox"},Xt=["value"],Zt=l(()=>t("span",{class:"cr"},[t("i",{class:"cr-icon glyphicon glyphicon-ok"})],-1)),te={class:"table-data-fixed-width"},ee={class:"sub-text"},se={class:"table-data-fixed-width"},oe={class:"sub-text"},ae={class:"table-data-fixed-width"},re={class:"table-data-fixed-width"},ne={class:"table-data-fixed-width"},ce={class:"table-data-fixed-width"},le={class:"d-flex align-items-center justify-content-between"},ie={class:"dropdown"},de=l(()=>t("img",{src:At,"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},null,-1)),ue={class:"dropdown-menu dropdown-menu-right pb-10 pt-10"},pe=["onClick"],_e=l(()=>t("img",{src:Dt,class:"icon"},null,-1)),ge=l(()=>t("span",{class:"ml-20 project-menu-action"},"View project",-1)),he=[_e,ge],me=["onClick"],ye=l(()=>t("img",{src:z},null,-1)),je=l(()=>t("span",{class:"ml-20 project-menu-action"},"Edit",-1)),fe=[ye,je],ve=["onClick"],be=l(()=>t("img",{src:et},null,-1)),Pe=l(()=>t("span",{class:"ml-20 project-menu-action delete"},"Delete",-1)),Se=[be,Pe];function Ce(s,e,n,c,o,a){const i=g("tabs"),j=g("Pagination"),I=g("delete-project"),K=g("loader");return _(),h("div",null,[t("div",Kt,[t("div",Lt,[Ot,f(t("input",{type:"text",class:"project-search p-10",placeholder:"Search","onUpdate:modelValue":e[0]||(e[0]=r=>o.projectSearchKeyword=r),onKeydown:e[1]||(e[1]=U((...r)=>a.getprojectSearchKeyword&&a.getprojectSearchKeyword(...r),["enter"]))},null,544),[[F,o.projectSearchKeyword]])])]),t("div",Vt,[t("p",Nt,d(o.total)+" Items",1),t("div",$t,[t("p",{class:u(["item-action deselect cursor-pointer",o.selectedProjects.length?"":"disabled"]),onClick:e[2]||(e[2]=(...r)=>a.deSelectAll&&a.deSelectAll(...r))}," Deselect All ",2),t("p",{class:u(["item-action delete ml-10 cursor-pointer",o.selectedProjects.length?"":"disabled"]),onClick:e[3]||(e[3]=r=>a.deletepopup(!0))},Ft,2)])]),t("div",Ut,[m(i,{tabs:o.projectTabCount,tabCount:o.projectTabCount,showTabCount:!1,modelValue:o.activeTabName,"onUpdate:modelValue":e[4]||(e[4]=r=>o.activeTabName=r),class:"mt-30"},null,8,["tabs","tabCount","modelValue"])]),t("div",Mt,[Object.keys(o.groupByStatus).length?(_(),h("table",Yt,[t("thead",null,[t("tr",null,[t("th",Ht,[t("div",Rt,[t("div",zt,[t("label",null,[f(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=r=>o.isSelectAll=r),onChange:e[6]||(e[6]=r=>a.setAllSelected())},null,544),[[T,o.isSelectAll]]),Gt])])])]),t("th",{onClick:e[7]||(e[7]=r=>a.setSortBy("project_name"))},[p(" Project Name "),t("span",{class:u(["sort-key",a.getSortKey("project_name")])},null,2)]),t("th",{onClick:e[8]||(e[8]=r=>a.setSortBy("email_address"))},[p(" Email "),t("span",{class:u(["sort-key",a.getSortKey("email_address")])},null,2)]),t("th",{onClick:e[9]||(e[9]=r=>a.setSortBy("consulting_name"))},[p(" Service "),t("span",{class:u(["sort-key",a.getSortKey("consulting_name")])},null,2)]),t("th",{onClick:e[10]||(e[10]=r=>a.setSortBy("requested_date"))},[p(" Requested Date "),t("span",{class:u(["sort-key",a.getSortKey("requested_date")])},null,2)]),t("th",{onClick:e[11]||(e[11]=r=>a.setSortBy("modified_date"))},[p(" Last modified "),t("span",{class:u(["sort-key",a.getSortKey("modified_date")])},null,2)]),t("th",{onClick:e[12]||(e[12]=r=>a.setSortBy("consulting_status"))},[p(" Status "),t("span",{class:u(["sort-key",a.getSortKey("consulting_status")])},null,2)])])]),t("tbody",null,[(_(!0),h(M,null,Y(o.groupByStatus[o.activeTabName],(r,L)=>(_(),h("tr",{key:r.consulting_name+"_"+L},[t("td",Jt,[t("div",Qt,[t("div",Wt,[t("label",null,[f(t("input",{type:"checkbox","onUpdate:modelValue":e[13]||(e[13]=y=>o.selectedProjects=y),value:r.consulting_user_info_id,onChange:e[14]||(e[14]=y=>a.onSelectAll())},null,40,Xt),[[T,o.selectedProjects]]),Zt])])])]),t("td",te,[t("div",null,d(r.project_name),1),t("div",ee,d(r.device_type),1)]),t("td",se,[t("div",null,d(r.email_address),1),t("div",oe,d(r.company_name),1)]),t("td",ae,d(r.consulting_name),1),t("td",re,d(r.requested_date),1),t("td",ne,d(r.modified_date),1),t("td",ce,[t("div",le,[t("span",{class:u(["project-status",[r.consulting_status]])},d(r.consulting_status),3),t("div",ie,[de,t("div",ue,[t("div",{class:"project-menu-action-container p-10",onClick:y=>a.viewProject(r.consulting_user_info_id)},he,8,pe),t("div",{class:"project-menu-action-container p-10",onClick:y=>a.editProject(r.consulting_user_info_id)},fe,8,me),t("div",{class:"project-menu-action-container p-10",onClick:y=>a.deletepopup(!1,r.consulting_user_info_id)},Se,8,ve)])])])])]))),128))])])):x("",!0),o.totalPages>1&&o.activeTabName==="all"?(_(),H(j,{key:1,totalPages:o.totalPages,total:o.total,perPage:o.perPage,currentPage:o.currentPage,onPagechanged:a.pagechanged},null,8,["totalPages","total","perPage","currentPage","onPagechanged"])):x("",!0)]),m(I,{onDeleteConsultantProject:a.deleteProject},null,8,["onDeleteConsultantProject"]),m(K,{loadingStatus:o.loaderStatus},null,8,["loadingStatus"])])}const we=v(It,[["render",Ce],["__scopeId","data-v-09f0317f"]]),Te={components:{ConsultingProjectsTable:we},data(){return{consultingProjectType:"",projects:[],projectTabs:{new:"New requests",inprogress:"In progress",complete:"Complete"},projectTabCount:{all:0,new:0,inprogress:0,complete:0},projectCategories:{},loaderStatus:!1}},created(){this.setupConsultingDetails()},methods:{async setupConsultingDetails(){this.consultingProjectType=this.$route.params.type,this.buildConsultingCategories()},buildConsultingCategories(){const s={};Object.keys(this.projectTabs).forEach(e=>{s[e]=[]}),this.projects.forEach(e=>{s[e.status].push(e)}),Object.keys(s).forEach(e=>{this.projectTabCount[e]=s[e].length}),s.all=this.projects,this.projectCategories=s,this.projectTabCount.all=this.projects.length},navigateToConsultingHours(){this.$router.go(-1)}}},D=s=>(b("data-v-a37800e0"),s=s(),P(),s),xe={class:"pl-30 pt-20 pr-20"},Be={class:"col-xs-12 p-0"},ke={class:"col-xs-12 search-header p-0"},Ae=D(()=>t("img",{class:"back-img cursor-pointer",src:st,alt:""},null,-1)),De=D(()=>t("p",{class:"tools-text font-18 mt-10 cursor-pointer",to:"/launchpad"}," Consulting Hours ",-1)),Ie=[Ae,De],Ke={class:"col-xs-12 p-0 mb-10 d-flex align-items-center justify-content-between"},Le={class:"heading-text"};function Oe(s,e,n,c,o,a){const i=g("consulting-projects-table");return _(),h("div",xe,[t("div",Be,[t("div",ke,[t("div",{class:"col-xs-12 mb-10 p-0 d-flex align-items-center col-gap-10 mb-20",onClick:e[0]||(e[0]=(...j)=>a.navigateToConsultingHours&&a.navigateToConsultingHours(...j))},Ie),t("div",Ke,[t("p",Le,d(o.consultingProjectType),1)]),m(i,{projectTabs:o.projectTabs,projectTabCount:o.projectTabCount,projectCategories:o.projectCategories,consultingProjectType:o.consultingProjectType},null,8,["projectTabs","projectTabCount","projectCategories","consultingProjectType"])])])])}const Ge=v(Te,[["render",Oe],["__scopeId","data-v-a37800e0"]]);export{Ge as default};
