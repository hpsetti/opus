import{l as g}from"./lodash-DhCEjwN-.js";import{O as D}from"./OpusCheckbox-DmKgoiup.js";import{_ as B,an as P,o as n,c as d,ai as m,a as u,F as p,m as b,n as o,k as y,t as _,ao as A,b as k,Q as N,e as F,r as v,p as M,f as T}from"./index-BlMJxPGQ.js";import{_ as z}from"./more-horizontal-YxyMY0P_.js";const w={name:"OpusDropdown",props:{id:{type:String,required:!0},position:{type:String,default:"dropdown",validator:e=>["dropup","dropdown"].includes(e)},align:{type:String,default:"right",validator:e=>["left","right"].includes(e)},menuOptions:{type:Array,default:()=>[]},item:{type:Object,default:()=>{}},noArrow:{type:Boolean,default:!1}},computed:{menuAlign(){return this.align==="right"?"dropdown-menu-right":"dropdown-menu-left"}},methods:{parseClasses:P}},E=["id"],H=["aria-labelledby","id"],L=["role","onClick"],V=["src"];function I(e,i,t,f,r,s){return n(),d("div",{class:o(["opus-menu",t.position])},[m(e.$slots,"default",{},()=>[u("img",{id:t.id,src:z,"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",class:"opus-icon d-inline-block cursor-pointer dropdown-toggle"},null,8,E)],!0),u("ul",{class:o(["dropdown-menu pb-10 pt-10",[{"no-arrow":t.noArrow},s.menuAlign]]),"aria-labelledby":t.id,id:t.id},[(n(!0),d(p,null,b(t.menuOptions,a=>(n(),d("li",{key:a.key,class:o([{"menu-container d-flex align-items-center":a.role!=="divider"},{disabled:typeof a.disabled=="function"?a.disabled(t.item):a.disabled},a.role,s.parseClasses(a.classes)]),role:a.role,onClick:C=>a.fn&&!(typeof a.disabled=="function"?a.disabled(t.item):a.disabled)?a.fn(t.item):null},[a.role!=="divider"?(n(),d(p,{key:0},[a.icon?(n(),d("img",{key:0,src:a.icon,class:"opus-icon sm icon-align"},null,8,V)):y("",!0),u("span",{class:o([s.parseClasses(a.contentClasses),"text-body-light menu-content"])},_(typeof a.name=="function"?a.name(t.item):a.name),3)],64)):y("",!0)],10,L))),128))],10,H)],2)}const R=B(w,[["render",I],["__scopeId","data-v-cf34c2ab"]]),K={name:"OpusTable",components:{OpusCheckbox:D,OpusDropdown:R},props:{id:{type:String,default:"opus-table"},items:{type:Array,default:()=>[]},fields:{type:Array,default:()=>[]},layout:{type:String,default:"default",validator:e=>["simple","default","card"].includes(e)},menuOptions:{type:Array,default:()=>[]},primaryKey:{type:String},size:{type:String,default:"sm",validator:e=>["sm","lg"].includes(e)},selectable:{type:Boolean,default:!1},showMenu:{type:Boolean,default:!0},tableBorderStyle:{type:String,default:"default",validator:e=>["default","bordered","borderless","outline"].includes(e)},fixed:{type:Boolean,default:!1},sticky:{type:Boolean,default:!1},tdClasses:{type:String,default:""},thClasses:{type:String,default:""},filter:{type:[String,Function],default:()=>""},filterIncludedFields:{type:Array,default:()=>[]},perPage:{type:Number,default:0},currentPage:{type:Number,default:1},responsive:{type:Boolean,default:!0}},computed:{isEmpty(){return this.body.length===0},isSimpleTable(){return this.layout==="simple"},hasMenu(){return!this.isSimpleTable&&this.menuOptions.length>0},isSortable(){return this.layout!=="simple"},isSelectable(){return this.layout!=="simple"&&this.selectable},allSelected(){return this.selectedItems.length===this.items.length},isSelectionPartial(){return this.selectedItems.length<this.items.length&&this.selectedItems.length>0},totalPages(){return Math.ceil(this.filteredItems.length/this.perPage)}},watch:{selectedItems:{handler(e){const i=this.body.filter((t,f)=>e.includes(f));this.$emit("row-selected",i),e.length===this.items.length&&this.$emit("all-selected")}},fields:{handler(e){this.header=e.map(i=>{let t={};return typeof i=="string"?(t.key=i,t.label=this.capitalize(i)):t=g.cloneDeep(i),t}),this.populateSortOptions()},immediate:!0},items:{handler:"itemHandler",immediate:!0},currentPage:{handler(){this.itemHandler(this.items)}},perPage:{handler(){this.itemHandler(this.items)}}},data(){return{header:[],body:[],sortBy:"name",sortDesc:!1,sortOptions:{},selectedItems:[],filteredItems:[]}},methods:{parseClasses:P,capitalize:A,isFirstCol(e){return e===0&&!this.isSelectable},isLastCol(e){return e===this.header.length-1&&!this.hasMenu},itemHandler(e){const i=g.cloneDeep(e);if(this.filter===""?this.filteredItems=i:typeof this.filter=="string"?this.filteredItems=i.filter(t=>{const f={};return this.filterIncludedFields.forEach(r=>{f[r]=t[r]}),JSON.stringify(f).includes(this.filter)}):this.filter&&typeof this.filter=="function"&&(this.filteredItems=i.filter(this.filter)),this.perPage===0)this.body=this.filteredItems;else{const t=this.currentPage;t<0&&t>this.totalPages&&(this.body=[]),this.body=this.filteredItems.slice((t-1)*this.perPage,t*this.perPage)}},populateSortOptions(){let e,i=!1;this.header.forEach(t=>{t.sortable&&(this.sortOptions[t.key]=!1,i||(e=t.key,i=!0))}),e&&(this.sortOptions[e]=!0)},getSortKey(e){let i="";return i+=this.sortOptions[e]?"asc":"desc",i+=this.sortBy===e?" active":" ",i},setSortBy(e){this.sortBy=e,this.sortOptions[e]=!this.sortOptions[e],this.sortDesc=this.sortOptions[e],this.body=g.orderBy(this.body,[e],[this.sortDesc?"desc":"asc"]),this.$emit("sort-changed",{sortBy:this.sortBy,sortDesc:this.sortDesc})},selectRow(e){const i=this.selectedItems.findIndex(t=>t===e);i===-1?this.selectedItems.push(e):this.selectedItems.splice(i,1)},selectAll(){this.allSelected?this.selectedItems=[]:this.selectedItems=this.body.map(e=>e.id)},menuPosition(e){return this.body.length<=4?"dropdown":e+this.menuOptions.length+1>=this.body.length?"dropup":"dropdown"}}},S=e=>(M("data-v-b2c9aeca"),e=e(),T(),e),j=["id"],q=["onClick"],J=S(()=>u("span",null,null,-1)),Q=[J],G=["onClick"],U=["onClick"],W=["innerHTML"],X={key:0,class:"text-center"},Y={colspan:"100%"},Z=S(()=>u("div",{class:"text-body-1"},"No results found!",-1)),x=S(()=>u("div",{class:"text-body-1"},"No records found!",-1));function $(e,i,t,f,r,s){const a=v("OpusCheckbox"),C=v("OpusDropdown");return n(),d("div",{class:o(["opus-table-container opus-scrollbar",[t.responsive]])},[u("table",{id:t.id,class:o(["opus-table",[t.tableBorderStyle,t.fixed]])},[u("thead",null,[u("tr",{class:o([t.size])},[s.isSelectable?(n(),d("th",{key:0,class:o(["first-col",[{sticky:t.sticky},s.parseClasses(t.thClasses)]])},[k(a,{checked:s.allSelected,indeterminate:s.isSelectionPartial,onInput:i[0]||(i[0]=h=>s.selectAll())},null,8,["checked","indeterminate"])],2)):y("",!0),(n(!0),d(p,null,b(r.header,(h,l)=>(n(),d("th",{key:h.key,class:o([{"first-col":s.isFirstCol(l)},{"last-col":s.isLastCol(l)},s.parseClasses(t.thClasses)]),style:N(h.thStyle),onClick:c=>h.sortable?s.setSortBy(h.key):null},[F(_(h.label)+" ",1),h.sortable?(n(),d("span",{key:0,class:o(["sort-key",s.getSortKey(h.key)])},null,2)):y("",!0)],14,q))),128)),s.hasMenu?(n(),d("th",{key:1,class:o(["last-col",[{sticky:t.sticky},s.parseClasses(t.thClasses)]])},Q,2)):y("",!0)],2)]),u("tbody",null,[(n(!0),d(p,null,b(r.body,(h,l)=>(n(),d("tr",{key:l,class:o({[`${t.size}`]:t.size,"first-row":l===0,"last-row":l===r.body.length-1,selected:r.selectedItems.includes(l)||s.allSelected,[`${h.trClass}`]:h.trClass}),onClick:c=>e.$emit("row-clicked",{item:r.body[l],index:l,$event:c})},[s.isSelectable?(n(),d("td",{key:0,class:o(["first-col",[{sticky:t.sticky},s.parseClasses(t.tdClasses)]])},[k(a,{checked:r.selectedItems.includes(l)?l:"",name:"opus-table-checkbox",value:l,uncheckedValue:l,onInput:c=>s.selectRow(l)},null,8,["checked","value","uncheckedValue","onInput"])],2)):y("",!0),(n(!0),d(p,null,b(r.header,(c,O)=>(n(),d("td",{key:c.key,class:o([{"first-col":s.isFirstCol(O)},{"last-col":s.isLastCol(O)},s.parseClasses(t.tdClasses)]),onClick:ee=>s.isSelectable?s.selectRow(l):null},[c.html?m(e.$slots,`cell(${c.key})`,{key:0,index:l,item:r.body[l],field:c.key,select:s.selectRow,value:r.body[l][c.key]},()=>[u("span",{innerHTML:r.body[l][c.key]},null,8,W)],!0):m(e.$slots,`cell(${c.key})`,{key:1,index:l,item:r.body[l],field:c.key,select:s.selectRow,value:r.body[l][c.key]},()=>[u("span",null,_(r.body[l][c.key]),1)],!0)],10,U))),128)),s.hasMenu&&t.showMenu?(n(),d("td",{key:1,class:o(["last-col",[{sticky:t.sticky},s.parseClasses(t.tdClasses)]])},[u("div",{class:o(["pr-20 pl-20 text-end align-right",[s.menuPosition(l)]])},[k(C,{id:`${t.id}-menu-${l}`,position:s.menuPosition(l),align:"right",menuOptions:t.menuOptions,item:r.body[l]},null,8,["id","position","menuOptions","item"])],2)],2)):y("",!0)],10,G))),128)),s.isEmpty?(n(),d("tr",X,[u("td",Y,[t.filter?m(e.$slots,"emptyfiltered",{key:0,emptyFilteredText:"No results found!"},()=>[Z],!0):m(e.$slots,"empty",{key:1,emptyText:"No records found!"},()=>[x],!0)])])):y("",!0)])],10,j)],2)}const ae=B(K,[["render",$],["__scopeId","data-v-b2c9aeca"]]);export{ae as O,R as a};
